<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>nRF5 SDK v13.0.0: Migration guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet_offline.css" rel="stylesheet" type="text/css"/>
<link href="nordic.css" rel="stylesheet" type="text/css" />
<link rel="Shortcut icon" href="./favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%" class="blank">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Nordic Semiconductor" src="nordic_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">nRF5 SDK
   &#160;<span id="projectnumber">v13.0.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<table cellspacing="0" cellpadding="0" class="blank">
<tr>
<td class="doclinkintro">Choose documentation:</td>
<td class="doclinks" id="nrf5"><a href="../nrf5/index.html">nRF5 SDK</a></td>
<td class="doclinks" id="s132"><a href="../s132/index.html">S132 SoftDevice API</a></td>
<td class="doclinks" id="s140"><a href="../s140/index.html">S140 SoftDevice API</a></td>
<td class="doclinks" id="s212"><a href="../s212/index.html">S212 SoftDevice API</a></td>
<!--<td class="doclinks" id="s332"><a href="../s332/index.html">S332 SoftDevice API</a></td>-->
</tr>
</table>
<script>
var url=window.location.href.split("/").reverse()[1];
var validLinks= ["nrf5","s132","s140","s212","s332"];
var index;
for (index = 0; index < validLinks.length; ++index) {
   if ( url.indexOf(validLinks[index]) !== -1 ) {
      document.getElementById(validLinks[index]).setAttribute('class', 'doclinks docselected');
   };
};
</script>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('migration.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Migration guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#migration_ble">Bluetooth low energy (BLE)</a><ul><li class="level2"><a href="#migration_ble_sds">New BLE SoftDevices</a></li>
<li class="level2"><a href="#migration_ble_sdhandler">SoftDevice handler</a></li>
<li class="level2"><a href="#migration_ble_adv">Advertising module</a></li>
<li class="level2"><a href="#migration_ble_nus">Nordic UART Service</a></li>
<li class="level2"><a href="#migration_ble_gatt">GATT module</a></li>
</ul>
</li>
<li class="level1"><a href="#migration_protocols">Other protocols</a><ul><li class="level2"><a href="#migration_protocols_sds">New ANT SoftDevice</a></li>
<li class="level2"><a href="#migration_protocols_nfc">BLE/NFC examples</a></li>
</ul>
</li>
<li class="level1"><a href="#migration_dfu">Secure DFU</a><ul><li class="level2"><a href="#migration_dfu_error">Extended error codes</a></li>
<li class="level2"><a href="#migration_dfu_52840">Secure DFU for nRF52840</a></li>
<li class="level2"><a href="#migration_dfu_buttonless">Buttonless DFU Service</a></li>
</ul>
</li>
<li class="level1"><a href="#migration_hw">Hardware peripherals</a><ul><li class="level2"><a href="#migration_hw_bsp">Board Support Package</a></li>
<li class="level2"><a href="#migration_hw_nrf_drv_power">POWER driver</a></li>
<li class="level2"><a href="#migration_hw_nrf_drv_pwm">PWM driver</a></li>
<li class="level2"><a href="#migration_hw_nrf_drv_spi">SPI master driver</a></li>
<li class="level2"><a href="#migration_hw_nrf_drv_csense">Capacitive Sensor low-level library</a></li>
<li class="level2"><a href="#migration_hw_nrf_pwr_mgmt">Power Management library</a></li>
<li class="level2"><a href="#migration_hw_app_timer">Timer library</a></li>
<li class="level2"><a href="#migration_hw_app_twi">TWI transaction manager</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>If you built an application based on nRF5 SDK v12.2.0, complete the actions listed in the following sections to migrate your application to nRF5 SDK v13.0.0.</p>
<p>Note that this migration guide does not list all changes, but it covers the most important changes that require you to update your code. See the <a class="el" href="index.html">release notes</a> for further information on changes that were made in this release.</p>
<h1><a class="anchor" id="migration_ble"></a>
Bluetooth low energy (BLE)</h1>
<h2><a class="anchor" id="migration_ble_sds"></a>
New BLE SoftDevices</h2>
<p>SDK v13.0.0 supports the BLE SoftDevices <b>S132 v4.0.2</b> and <b>S140 v5.0.0-2.alpha</b>. The SDK was adapted to the newest SoftDevice API.</p>
<p>For additional details about the SoftDevices, see s132_nrf52_4.0.2_migration-document.pdf and s132_nrf52_4.0.2_releasenotes.pdf located in <code>components\softdevice\s132\doc</code> and s140_nrf52840_5.0.0-2.alpha_migration-document.pdf and s140_nrf52840_5.0.0-2.alpha_release-notes-update-1.pdf located in <code>components\softdevice\s140\doc</code>.</p>
<p><em><b>Action:</b> If you use direct SoftDevice calls, follow the steps outlined in the SoftDevice migration documents to update your application to the newest API.</em></p>
<h2><a class="anchor" id="migration_ble_sdhandler"></a>
SoftDevice handler</h2>
<p>The following changes were done to the API of the <a class="el" href="lib_softdevice_handler.html">SoftDevice handler library</a><span></span>:</p>
<ul>
<li><b>New API:</b> <a class="el" href="group__softdevice__handler.html#ga7a3ff66ff940c4174bf58e6c39ae23df">softdevice_app_ram_start_get(uint32_t * app_ram_base)</a></li>
<li><p class="startli"><b>Changed API:</b> <a class="el" href="group__softdevice__handler.html#gafe078b9078d9100706277e2b9215b8fd">softdevice_enable(uint32_t * ram_start)</a> (before: <code>softdevice_enable(ble_enable_params_t * ble_enable_params)</code>)</p>
<p class="startli">Previously, the RAM start address was used only internally in <a class="el" href="group__softdevice__handler.html#gafe078b9078d9100706277e2b9215b8fd">softdevice_enable</a>. Now, it is needed in the new SoftDevice call <a class="elRef" doxygen="tag_s140_offline.tag:../s140/" href="../s140/group___b_l_e___c_o_m_m_o_n___f_u_n_c_t_i_o_n_s.html#ga4edae2bac8c68b672c0fa101ed2c687f">sd_ble_cfg_set</a>, which may be called several times before <a class="el" href="group__softdevice__handler.html#gafe078b9078d9100706277e2b9215b8fd">softdevice_enable</a>.</p>
<p class="startli"><em><b>Action:</b> Make sure to call <a class="el" href="group__softdevice__handler.html#ga7a3ff66ff940c4174bf58e6c39ae23df">softdevice_app_ram_start_get</a> before calling <a class="elRef" doxygen="tag_s140_offline.tag:../s140/" href="../s140/group___b_l_e___c_o_m_m_o_n___f_u_n_c_t_i_o_n_s.html#ga4edae2bac8c68b672c0fa101ed2c687f">sd_ble_cfg_set</a> and <a class="el" href="group__softdevice__handler.html#gafe078b9078d9100706277e2b9215b8fd">softdevice_enable</a>, and update your calls to <a class="el" href="group__softdevice__handler.html#gafe078b9078d9100706277e2b9215b8fd">softdevice_enable</a>.</em></p>
</li>
<li><p class="startli"><b>Removed API:</b> <code>softdevice_enable_get_default_config</code> </p>
<p class="startli"><a class="elRef" doxygen="tag_s140_offline.tag:../s140/" href="../s140/group___b_l_e___c_o_m_m_o_n___f_u_n_c_t_i_o_n_s.html#ga4edae2bac8c68b672c0fa101ed2c687f">sd_ble_cfg_set</a> along with new default values supplied by the SoftDevice has eliminated the old scheme of fetching an SDK-defined default from <code>softdevice_enable_get_default_config</code>.</p>
<p class="startli"><em><b>Action:</b> Remove all calls to <code>softdevice_enable_get_default_config</code>.</em></p>
</li>
</ul>
<p>For all BLE examples, the <code>ble_stack_init</code> function was updated to reflect the required changes. Function calls preceding <a class="elRef" doxygen="tag_s140_offline.tag:../s140/" href="../s140/group___b_l_e___c_o_m_m_o_n___f_u_n_c_t_i_o_n_s.html#ga8a92420df90945526d4c89d09486508d">sd_ble_enable</a> have changed to reflect the new SoftDevice.</p>
<p><em><b>Action:</b> Update your application as shown in the BLE examples.</em></p>
<h2><a class="anchor" id="migration_ble_adv"></a>
Advertising module</h2>
<p>The following API was added to the <a class="el" href="lib_ble_advertising.html">Advertising Module</a><span></span>:</p>
<ul>
<li><a class="el" href="group__ble__advertising.html#ga3786bd53e8b22922ba6d0d9109863249">ble_advertising_conn_cfg_tag_set(uint8_t ble_cfg_tag)</a></li>
</ul>
<p>This function sets the configuration tag that is used for a connection in the advertising module. Any connection that is made uses the connection configuration tag that is currently set. If the new API function is not called, a default connection tag is used.</p>
<p><a class="el" href="group__ble__advertising.html#ga3786bd53e8b22922ba6d0d9109863249">ble_advertising_conn_cfg_tag_set</a> must be called after <a class="el" href="group__ble__advertising.html#ga1aa5ac2cc4100bde75f2d41d5c11c221">ble_advertising_init</a>, but before <a class="el" href="group__ble__advertising.html#ga944db395f3667276eb62a8bf3d0583ad">ble_advertising_start</a>.</p>
<p>The connection configuration tag is the tag used in <a class="elRef" doxygen="tag_s140_offline.tag:../s140/" href="../s140/group___b_l_e___c_o_m_m_o_n___f_u_n_c_t_i_o_n_s.html#ga4edae2bac8c68b672c0fa101ed2c687f">sd_ble_cfg_set</a>. In the SDK examples, the tag is set up during ble_stack_init.</p>
<p><em><b>Action:</b> Use this function if you want to use non-default settings for an upcoming connection.</em></p>
<h2><a class="anchor" id="migration_ble_nus"></a>
Nordic UART Service</h2>
<p>In the <a class="el" href="group__ble__nus.html">Nordic UART Service</a> and <a class="el" href="group__ble__nus__c.html">Nordic UART Service Client</a>, the terminology use of RX and TX was inverted compared to the apps that can interact with the service (for example, the nRF Toolbox UART app). This mismatch has been corrected in this release. As a result, the names of a few of the functions in the Nordic UART Service have changed.</p>
<p><em><b>Action:</b> Update your function calls from <code>ble_nus_c_rx_notif_enable</code> (old) to <a class="el" href="group__ble__nus__c.html#ga460ba83f3a3e5f9d75b5da24259ee4da">ble_nus_c_tx_notif_enable</a> (new).</em></p>
<p>The <a class="el" href="ble_sdk_app_nus_eval.html">UART/Serial Port Emulation over BLE</a> example was changed to not check for a '\r' character when parsing input from UART, because it would send empty packets over the air when "\r\n" was together. Therefore, UART terminals used with the ble_app_uart example must send '\n' as newline. Sending '\r' alone is not sufficient.</p>
<p><em><b>Action:</b> Update your terminals to use '\n' as newline when interacting with the ble_app_uart example.</em></p>
<h2><a class="anchor" id="migration_ble_gatt"></a>
GATT module</h2>
<p>The following changes were done to the <a class="el" href="lib_ble_gatt.html">Experimental: GATT Module</a><span></span>:</p>
<ul>
<li><p class="startli">The library now handles <a class="elRef" doxygen="tag_s140_offline.tag:../s140/" href="../s140/group___b_l_e___g_a_p___e_n_u_m_e_r_a_t_i_o_n_s.html#ggada486dd3c0cce897b23a887bed284fefa72dff3660a5414e3f7abddd844070e55">BLE_GAP_EVT_DATA_LENGTH_UPDATE_REQUEST</a> and <a class="elRef" doxygen="tag_s140_offline.tag:../s140/" href="../s140/group___b_l_e___g_a_p___e_n_u_m_e_r_a_t_i_o_n_s.html#ggada486dd3c0cce897b23a887bed284fefaba4779e3134fa9ac3ac38c502d4a9d51">BLE_GAP_EVT_DATA_LENGTH_UPDATE</a> events from the SoftDevice. Note that the library currently supports only symmetric data length RX/TX values.</p>
<p class="startli"><em><b>Action:</b> If you handled these two events manually in your application, you can now use the GATT module instead.</em></p>
</li>
<li><p class="startli">The structure <a class="el" href="structnrf__ble__gatt__evt__t.html">nrf_ble_gatt_evt_t</a> was changed to include the event type and parameters (as a union):</p>
<p class="startli"><b>Old:</b> </p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line">{</div>
<div class="line">   uint16_t conn_handle;</div>
<div class="line">   uint16_t att_mtu_effective;</div>
<div class="line">} <a class="code" href="structnrf__ble__gatt__evt__t.html" title="GATT module event.">nrf_ble_gatt_evt_t</a>;</div>
</div><!-- fragment --><p class="startli"><b>New:</b> </p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line">{</div>
<div class="line">    <a class="code" href="group__nrf__ble__gatt.html#ga1b541b8461301bfe4f1df32eed458629" title="GATT module event types.">nrf_ble_gatt_evt_id_t</a> evt_id;</div>
<div class="line">    uint16_t conn_handle;</div>
<div class="line">    <span class="keyword">union</span></div>
<div class="line">    {</div>
<div class="line">        uint16_t att_mtu_effective;</div>
<div class="line">        uint8_t data_length;</div>
<div class="line">    } params;</div>
<div class="line">} <a class="code" href="structnrf__ble__gatt__evt__t.html" title="GATT module event.">nrf_ble_gatt_evt_t</a>;</div>
</div><!-- fragment --><p class="startli"><em><b>Action:</b> Update your event handlers to handle the changed <a class="el" href="structnrf__ble__gatt__evt__t.html">nrf_ble_gatt_evt_t</a>.</em></p>
</li>
</ul>
<ul>
<li><p class="startli">The <a class="el" href="lib_ble_gatt.html">Experimental: GATT Module</a> (nrf_ble_gatt) was included in all BLE example applications. ATT_MTU exchange and data length update procedures are handled by the library and need not be handled manually by the application anymore.</p>
<p class="startli"><em><b>Action:</b> Update your application as shown in the BLE examples.</em></p>
</li>
</ul>
<h1><a class="anchor" id="migration_protocols"></a>
Other protocols</h1>
<h2><a class="anchor" id="migration_protocols_sds"></a>
New ANT SoftDevice</h2>
<p>SDK v13.0.0 supports the ANT SoftDevice S212 v4.0.0. The <a class="el" href="lib_ant_channel_config.html">ANT channel configuration</a> was adapted to the newest SoftDevice API.</p>
<p>For additional details about the ANT SoftDevices, see <a href="http://www.thisisant.com/developer/components/nrf52832" target="_blank">thisisant.com</a>.</p>
<p><em><b>Action:</b> The new S212 SoftDevice API is an extension of the v2.0.0, so no updates are required unless you want to use added functionality.</em></p>
<h2><a class="anchor" id="migration_protocols_nfc"></a>
BLE/NFC examples</h2>
<p>The following BLE/NFC examples were refactored to use the <a class="el" href="nfc_ble_pair_lib_dox.html">NFC BLE pairing library</a><span></span>:</p>
<ul>
<li><a class="el" href="ble_sdk_app_hrs_nfc_pairing.html">Experimental: Heart Rate Application with BLE Pairing Using NFC Pairing Library</a></li>
<li><a class="el" href="ble_sdk_app_hid_keyboard_pairing_nfc.html">Experimental: HID Keyboard Application with BLE pairing using NFC</a></li>
<li><a class="el" href="ble_sdk_nfc_pairing_reference.html">Experimental: BLE Pairing Using NFC - Peripheral Reference Example</a></li>
</ul>
<p><em><b>Action:</b> For the above examples, select the desired pairing mode in the <code>sdk_config.h</code> file:</em></p>
<ul>
<li><a class="el" href="group__nfc__ble__pair__lib.html#ggac2b22ae41bddc6148b2ee82f4383837eaa8daeb56f3af4563301b99c64b623b06">NFC_PAIRING_MODE_JUST_WORKS</a></li>
<li><a class="el" href="group__nfc__ble__pair__lib.html#ggac2b22ae41bddc6148b2ee82f4383837ea7230d7932fa21c40094ac71dde3c7872">NFC_PAIRING_MODE_OOB</a></li>
<li><a class="el" href="group__nfc__ble__pair__lib.html#ggac2b22ae41bddc6148b2ee82f4383837ea99630e0e85cde79b55574bee67e03e41">NFC_PAIRING_MODE_LESC_JUST_WORKS</a></li>
<li><a class="el" href="group__nfc__ble__pair__lib.html#ggac2b22ae41bddc6148b2ee82f4383837ea1358f7c3f5d830ba0fa71b7424f5fa67">NFC_PAIRING_MODE_LESC_OOB</a></li>
</ul>
<h1><a class="anchor" id="migration_dfu"></a>
Secure DFU</h1>
<h2><a class="anchor" id="migration_dfu_error"></a>
Extended error codes</h2>
<p>Extended error codes is a new set of error codes that the DFU target may send as a response to the DFU controller. When the DFU controller receives an error code "0x0B", this indicates that the next byte of the packet contains more detailed information about the cause of the error.</p>
<p><em><b>Action:</b> If you have an implementation of, for example, a mobile app for performing DFU, update it to handle the new "0x0B" error code.</em></p>
<h2><a class="anchor" id="migration_dfu_52840"></a>
Secure DFU for nRF52840</h2>
<p>On nRF52840 devices, the bootloader is now located at the end of the device's flash area (0xF8000). This allows for larger applications to coexist with the bootloader.</p>
<p><em><b>Action:</b> Make sure that the bootloader settings page is at the correct location. <a href="http://infocenter.nordicsemi.com/topic/com.nordic.infocenter.tools/dita/tools/nrfutil/nrfutil_intro.html">nrfutil</a> accepts <code>"--family NRF52840"</code> to generate a bootloader settings page that is compatible with nRF52840 devices.</em></p>
<h2><a class="anchor" id="migration_dfu_buttonless"></a>
Buttonless DFU Service</h2>
<p>The <a class="el" href="group__ble__dfu.html">Buttonless DFU Service</a> now uses the Nordic proprietary 16-bit UUID reserved for Nordic Secure DFU (0xFE59).</p>
<p>The Buttonless DFU characteristic has a new UUID: 0x8EC90003-F315-4F60-9FB8-838830DAEA50. It has been changed from notification to indication.</p>
<p><em><b>Action:</b> Update your application that interacts with the Buttonless DFU Service to use the new UUID and to handle incoming indications instead of notifications on the Buttonless DFU characteristic.</em></p>
<h1><a class="anchor" id="migration_hw"></a>
Hardware peripherals</h1>
<h2><a class="anchor" id="migration_hw_bsp"></a>
Board Support Package</h2>
<p><b>Changed API:</b> The <code>ticks_per_100ms</code> parameter was removed from the <a class="el" href="lib_bsp.html">Board Support Package (BSP)</a> initialization function <a class="el" href="group__bsp.html#ga61f2abcbc19d294a7ab8e4a43de5a204">bsp_init</a>.</p>
<p><em><b>Action:</b> Remove the <code>ticks_per_100ms</code> parameter from the function call.</em></p>
<h2><a class="anchor" id="migration_hw_nrf_drv_power"></a>
POWER driver</h2>
<p>The API functions of the <a class="el" href="group__nrf__drv__power.html">POWER driver</a> now return error codes. The driver must be initialized before the SoftDevice is enabled.</p>
<p><em><b>Action:</b> Handle the return codes in your application.</em></p>
<h2><a class="anchor" id="migration_hw_nrf_drv_pwm"></a>
PWM driver</h2>
<p>The <a class="el" href="group__nrf__drv__pwm.html#ga14bfdc60b33bb74014c204f2640ad255">nrf_drv_pwm_simple_playback</a> and <a class="el" href="group__nrf__drv__pwm.html#ga14bfdc60b33bb74014c204f2640ad255">nrf_drv_pwm_simple_playback</a> functions of the <a class="el" href="hardware_driver_pwm.html">PWM</a> driver now return error codes. However, they will always return <a class="elRef" doxygen="tag_s212_offline.tag:../s212/" href="../s212/group__nrf__error.html#ga7e6367efeaac363d8cf024940b4ec123">NRF_SUCCESS</a> unless PPI is used to trigger playback.</p>
<p><em><b>Action:</b> If you are using PPI to trigger playback, handle the return codes in your application. Otherwise, ignore the return codes.</em></p>
<h2><a class="anchor" id="migration_hw_nrf_drv_spi"></a>
SPI master driver</h2>
<p><b>Changed API:</b> The <a class="el" href="group__nrf__drv__spi.html#ga2319de449c320ce104d8f3b40759c64c">nrf_drv_spi_init</a> function and the event handler of the <a class="el" href="hardware_driver_spi_master.html">SPI master</a> driver require a new parameter <code>p_context</code>. This parameter is returned in the event handler.</p>
<p><em><b>Action:</b> Update your function calls. If you do not want to use the new feature, pass <code>p_context=NULL</code>.</em></p>
<h2><a class="anchor" id="migration_hw_nrf_drv_csense"></a>
Capacitive Sensor low-level library</h2>
<p>The <a class="el" href="lib_csense_lowlevel.html">Capacitive Sensor low-level library</a> can use <a class="el" href="hardware_driver_comp.html">COMP</a> or <a class="el" href="hardware_driver_saadc.html">SAADC</a>. However, COMP is not recommended because of <a href="http://infocenter.nordicsemi.com/topic/com.nordic.infocenter.nrf52832.Rev1.errata/anomaly_832_84.html">Anomaly 84</a>.</p>
<p><em><b>Action:</b> Update <code>sdk_config.h</code> and configure the module to use SAADC.</em></p>
<h2><a class="anchor" id="migration_hw_nrf_pwr_mgmt"></a>
Power Management library</h2>
<p><b>Changed API:</b> The <code>ticks_per_1s</code> parameter was removed from the <a class="el" href="lib_pwr_mgmt.html">Power Management library</a> initialization function <a class="el" href="group__nrf__pwr__mgmt.html#ga1e61d9e9133cc129acfa171eb8f67bba">nrf_pwr_mgmt_init</a>.</p>
<p><em><b>Action:</b> Remove the <code>ticks_per_1s</code> parameter from the function call.</em></p>
<h2><a class="anchor" id="migration_hw_app_timer"></a>
Timer library</h2>
<p>The following changes were done to the <a class="el" href="lib_timer.html">Timer library</a><span></span>:</p>
<ul>
<li><p class="startli">The static configuration of the library (prescaler, queue size, use of app_scheduler) was moved to <code>sdk_config.h</code>.</p>
<p class="startli"><em><b>Action:</b> Update your <code>sdk_config.h</code> file with the new parameters.</em></p>
</li>
<li><p class="startli"><b>Removed API:</b> <code>APP_TIMER_INIT</code> </p>
<p class="startli"><em><b>Action:</b> Replace calls to the <code>APP_TIMER_INIT</code> macro with calls to the <a class="el" href="group__app__timer.html#ga6dfeb220d038adefe101dd483c48d036">app_timer_init</a> function.</em></p>
</li>
<li><p class="startli"><b>Changed API:</b> The <code>PRESCALER</code> parameter of the <a class="el" href="group__app__timer.html#ga366b87f5e3b8d881f22a7209e5b3ae82">APP_TIMER_TICKS</a> macro was removed.</p>
<p class="startli"><em><b>Action:</b> Remove the <code>PRESCALER</code> parameter from the macro call.</em></p>
</li>
<li><p class="startli">The <code>app_timer_appsh</code> module was removed.</p>
<p class="startli"><em><b>Action:</b> If you used the app_timer_appsh module, replace calls to <code>APP_TIMER_APPSH_INIT</code> with calls to <a class="el" href="group__app__timer.html#ga6dfeb220d038adefe101dd483c48d036">app_timer_init</a> and enable the <a class="el" href="group__app__timer__config.html#gaebe2a7e5df128a2bc3f4a91f7155a725">APP_TIMER_CONFIG_USE_SCHEDULER</a> option in <code>sdk_config.h</code>.</em></p>
</li>
</ul>
<h2><a class="anchor" id="migration_hw_app_twi"></a>
TWI transaction manager</h2>
<p>The following changes were done to the <a class="el" href="lib_app_twi.html">TWI transaction manager</a><span></span>:</p>
<ul>
<li>The <a class="el" href="lib_app_twi.html">TWI transaction manager</a> was extended to be able to provide TWI configuration for each transaction.</li>
<li><p class="startli"><b>Removed API:</b> <code>APP_TWI_INIT</code> </p>
<p class="startli"><em><b>Action:</b> Replace calls to <code>APP_TWI_INIT(&amp;m_app_twi, &amp;config, QUEUE_SIZE, err_code)</code> with calls to <code>app_twi_init(&amp;m_app_twi, &amp;config)</code>.</em></p>
</li>
<li><p class="startli"><b>New API:</b> <a class="el" href="group__app__twi.html#ga109216649be2bb0487ab2a621f409779">APP_TWI_DEF</a></p>
<p class="startli"><em><b>Action:</b> Replace the code <code><a class="el" href="structapp__twi__t.html" title="TWI transaction manager instance.">app_twi_t</a> m_app_twi = APP_TWI_INSTANCE(TWI_IDX)</code> with <a class="el" href="group__app__twi.html#ga109216649be2bb0487ab2a621f409779" title="Macro that simplifies defining a TWI transaction manager instance.">APP_TWI_DEF(m_app_twi, QUEUE_SIZE, TWI_IDX)</a>.</em> </p>
</li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div id="nav-path" class="topicfooter">
<a href="mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback" id="maillink">Documentation feedback</a> | <a href="https://devzone.nordicsemi.com/questions/" target="_blank">Developer Zone</a> | <a href="http://response.nordicsemi.com/subscribe-to-our-newsletters" target="_blank">Subscribe</a> | Updated <span id="date"/>
<script>
var date = new Date("Fri Mar 10 2017" + " UTC");
document.getElementById("date").innerHTML = date.toJSON().slice(0, 10);
var url=window.location.href.split("?")[0];
var filename=url.substring(url.lastIndexOf('/')+1);
document.getElementById("maillink").href = "mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback"+decodeURIComponent("%26")+"body=File%20name%3A%20"+encodeURIComponent(filename);
</script>
</div>
</body>
</html>
