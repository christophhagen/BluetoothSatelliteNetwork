<!-- HTML header for doxygen 1.8.3.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>nRF5 SDK v13.0.0: PWM</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="extra_stylesheet_offline.css" rel="stylesheet" type="text/css"/>
<link href="nordic.css" rel="stylesheet" type="text/css" />
<link rel="Shortcut icon" href="./favicon.ico" type="image/x-icon" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" width="100%" class="blank">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Nordic Semiconductor" src="nordic_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">nRF5 SDK
   &#160;<span id="projectnumber">v13.0.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
<table cellspacing="0" cellpadding="0" class="blank">
<tr>
<td class="doclinkintro">Choose documentation:</td>
<td class="doclinks" id="nrf5"><a href="../nrf5/index.html">nRF5 SDK</a></td>
<td class="doclinks" id="s132"><a href="../s132/index.html">S132 SoftDevice API</a></td>
<td class="doclinks" id="s140"><a href="../s140/index.html">S140 SoftDevice API</a></td>
<td class="doclinks" id="s212"><a href="../s212/index.html">S212 SoftDevice API</a></td>
<!--<td class="doclinks" id="s332"><a href="../s332/index.html">S332 SoftDevice API</a></td>-->
</tr>
</table>
<script>
var url=window.location.href.split("/").reverse()[1];
var validLinks= ["nrf5","s132","s140","s212","s332"];
var index;
for (index = 0; index < validLinks.length; ++index) {
   if ( url.indexOf(validLinks[index]) !== -1 ) {
      document.getElementById(validLinks[index]).setAttribute('class', 'doclinks docselected');
   };
};
</script>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('hardware_driver_pwm.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">PWM </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The Pulse Width Modulation (PWM) module driver includes two layers: the hardware access layer (HAL) and the driver layer (DRV).</p>
<p>The hardware access layer provides basic APIs for accessing the registers of the PWM peripheral. See the API documentation for the <a class="el" href="group__nrf__pwm__hal.html">PWM HAL</a> for details.</p>
<p>The driver layer provides APIs on a higher level than the HAL. See the API documentation for the <a class="el" href="group__nrf__drv__pwm.html">PWM driver</a> for details.</p>
<p>Key features include:</p>
<ul>
<li>Multi-instance support</li>
<li>Two kinds of playback:<ul>
<li>Simple: a single sequence of duty cycle values</li>
<li>Complex: two concatenated sequences</li>
</ul>
</li>
<li>Sequences are played back a specified number of times</li>
<li>Optionally, the whole playback can be repeated in a loop</li>
<li>A user-defined event handler can be used to perform additional actions when a sequence or the whole playback is finished</li>
<li>If no event handler is used, playbacks can be carried out without involving the CPU</li>
</ul>
<p>The <a class="el" href="pwm_hw_example.html">PWM Driver Example</a> provides sample code that you can use to quickly get started.</p>
<h1><a class="anchor" id="pwm_driver_configuration"></a>
Driver configuration</h1>
<p>The configurable parameters include:</p>
<ul>
<li>Pins to be used as outputs for PWM channels (up to 4 per instance)</li>
<li>Base clock frequency and top counter value (these parameters jointly determine the PWM period and resolution)</li>
<li>Mode of loading the sequence values from RAM and distributing them to compare registers:<ul>
<li>Common: One value is used in all channels.</li>
<li>Grouped: One value is used in channels 0 and 1, and another one in channels 2 and 3.</li>
<li>Individual: Separate values are used in each channel.</li>
<li>Waveform: Similar to Individual mode, but only three channels are used. The fourth value is loaded into the pulse generator counter as its top value.</li>
</ul>
</li>
<li>Mode of advancing the active sequence (automatic or triggered via a task)</li>
</ul>
<p>The default configuration for the PWM driver is located in <code>sdk_config.h</code>. This configuration is used when <a class="el" href="group__nrf__drv__pwm.html#ga61b4f3c36552d7f63840e068142dd625">nrf_drv_pwm_init</a> is called with a NULL pointer to the configuration structure.</p>
<p>Before it can be used for a particular instance of the peripheral, the driver must be explicitly enabled for this instance in <code>sdk_config.h</code>.</p>
<h1><a class="anchor" id="pwm_driver_using"></a>
Using the PWM driver</h1>
<p>First, call <a class="el" href="group__nrf__drv__pwm.html#ga61b4f3c36552d7f63840e068142dd625">nrf_drv_pwm_init</a> to initialize and configure the driver for a given instance of the peripheral. See the <a class="el" href="structnrf__drv__pwm__config__t.html">nrf_drv_pwm_config_t</a> structure documentation for possible configuration options.</p>
<p>For example:</p>
<div class="fragment"><div class="line">uint32_t err_code;</div>
<div class="line"><a class="code" href="structnrf__drv__pwm__config__t.html" title="PWM driver configuration structure.">nrf_drv_pwm_config_t</a> <span class="keyword">const</span> config0 =</div>
<div class="line">{</div>
<div class="line">    .<a class="code" href="structnrf__drv__pwm__config__t.html#a26ed935fa23f81050d9f7e3449737c57" title="Pin numbers for individual output channels (optional).">output_pins</a> =</div>
<div class="line">    {</div>
<div class="line">        BSP_LED_0 | <a class="code" href="group__nrf__drv__pwm.html#gac9b3208417530b69e5700eba37474a66" title="This value can be added to a pin number to inverse its polarity (set idle state = 1)...">NRF_DRV_PWM_PIN_INVERTED</a>, <span class="comment">// channel 0</span></div>
<div class="line">        <a class="code" href="group__nrf__drv__pwm.html#ga47c4399de7c5eb9eb365f03892f1bba6" title="This value can be provided instead of a pin number for any channel to specify that its output is not ...">NRF_DRV_PWM_PIN_NOT_USED</a>,             <span class="comment">// channel 1</span></div>
<div class="line">        <a class="code" href="group__nrf__drv__pwm.html#ga47c4399de7c5eb9eb365f03892f1bba6" title="This value can be provided instead of a pin number for any channel to specify that its output is not ...">NRF_DRV_PWM_PIN_NOT_USED</a>,             <span class="comment">// channel 2</span></div>
<div class="line">        <a class="code" href="group__nrf__drv__pwm.html#ga47c4399de7c5eb9eb365f03892f1bba6" title="This value can be provided instead of a pin number for any channel to specify that its output is not ...">NRF_DRV_PWM_PIN_NOT_USED</a>,             <span class="comment">// channel 3</span></div>
<div class="line">    },</div>
<div class="line">    .irq_priority = APP_IRQ_PRIORITY_LOW,</div>
<div class="line">    .base_clock   = <a class="code" href="group__nrf__pwm__hal.html#gga8479da20e14394fb2388b1be3b879670a30e595429e6787e18df7ca04b897bb11" title="16 MHz / 16 = 1 MHz.">NRF_PWM_CLK_1MHz</a>,</div>
<div class="line">    .count_mode   = <a class="code" href="group__nrf__pwm__hal.html#gga1f29b190ff13c52895d249e07ebe92cba0b9d394af2cbadb2fd430f73e6b2a28c" title="Up counter (edge-aligned PWM duty cycle).">NRF_PWM_MODE_UP</a>,</div>
<div class="line">    .top_value    = 1000,</div>
<div class="line">    .load_mode    = <a class="code" href="group__nrf__pwm__hal.html#gga453888e5feb46774da27499ca1eeafd2a23a17dad88a8dff161e09c5057e70362" title="1st half word (16-bit) used in all PWM channels (0-3).">NRF_PWM_LOAD_COMMON</a>,</div>
<div class="line">    .step_mode    = <a class="code" href="group__nrf__pwm__hal.html#ggae25a7e03c383934d33cda8a049b7dde4aec7f52e96da457170f1a516ea78357a1" title="Automatically after the current value is played and repeated the requested number of times...">NRF_PWM_STEP_AUTO</a></div>
<div class="line">};</div>
<div class="line">err_code = <a class="code" href="group__nrf__drv__pwm.html#ga61b4f3c36552d7f63840e068142dd625" title="Function for initializing the PWM driver.">nrf_drv_pwm_init</a>(&amp;m_pwm0, &amp;config0, NULL);</div>
<div class="line"><span class="keywordflow">if</span> (err_code != NRF_SUCCESS)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">// Initialization failed. Take recovery action.</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>Next, define a sequence of duty cycle values using the <a class="el" href="structnrf__pwm__sequence__t.html">nrf_pwm_sequence_t</a> structure. For example: </p>
<div class="fragment"><div class="line"><span class="keyword">static</span> <a class="code" href="group__nrf__pwm__hal.html#ga5a7353575cd92e960e569d94db319d8d" title="Type used for defining duty cycle values for a sequence loaded in NRF_PWM_LOAD_COMMON mode...">nrf_pwm_values_common_t</a> seq_values[] =</div>
<div class="line">{</div>
<div class="line">    0, 200, 400, 600, 800, 1000</div>
<div class="line">};</div>
<div class="line"><a class="code" href="structnrf__pwm__sequence__t.html" title="Structure for defining a sequence of PWM duty cycles.">nrf_pwm_sequence_t</a> <span class="keyword">const</span> seq =</div>
<div class="line">{</div>
<div class="line">    .<a class="code" href="structnrf__pwm__sequence__t.html#ad3244198df7ea3a206740dacd398db1e" title="Pointer to an array with duty cycle values. This array must be in Data RAM.">values</a>.<a class="code" href="unionnrf__pwm__values__t.html#a1ea60c2c70461503fd4f27d268a5d378" title="Pointer to be used in NRF_PWM_LOAD_COMMON mode.">p_common</a> = seq_values,</div>
<div class="line">    .length          = <a class="code" href="group__nrf__pwm__hal.html#ga22d0be020efeeabd0da15cf6a458beeb" title="Helper macro for calculating the number of 16-bit values in specified array of duty cycle values...">NRF_PWM_VALUES_LENGTH</a>(seq_values),</div>
<div class="line">    .repeats         = 0,</div>
<div class="line">    .end_delay       = 0</div>
<div class="line">};</div>
</div><!-- fragment --><p>Start the playback of the sequence by calling <a class="el" href="group__nrf__drv__pwm.html#ga14bfdc60b33bb74014c204f2640ad255">nrf_drv_pwm_simple_playback</a>.</p>
<p>You can play the sequence several times (for example, 3 times): </p>
<div class="fragment"><div class="line"><a class="code" href="group__nrf__drv__pwm.html#ga14bfdc60b33bb74014c204f2640ad255" title="Function for starting a single sequence playback.">nrf_drv_pwm_simple_playback</a>(&amp;m_pwm0, &amp;seq, 3, 0);</div>
</div><!-- fragment --><p>Additionally, the playback can be repeated in a loop: </p>
<div class="fragment"><div class="line"><a class="code" href="group__nrf__drv__pwm.html#ga14bfdc60b33bb74014c204f2640ad255" title="Function for starting a single sequence playback.">nrf_drv_pwm_simple_playback</a>(&amp;m_pwm0, &amp;seq, 3, <a class="code" href="group__nrf__drv__pwm.html#gga770fe6d424dc8d8de9c905f32dba4bd1aee252ad8381cb217975de23d23f05b88">NRF_DRV_PWM_FLAG_LOOP</a>);</div>
</div><!-- fragment --><p>If a more complicated pattern of duty cycles is required that involves two sequence definitions, use <a class="el" href="group__nrf__drv__pwm.html#gaf5c6c163024bbdfa0e20d97f032a8776">nrf_drv_pwm_complex_playback</a>.</p>
<p>If a sequence must be updated during the playback, define a proper event handler and pass it as parameter in the call to <a class="el" href="group__nrf__drv__pwm.html#ga61b4f3c36552d7f63840e068142dd625">nrf_drv_pwm_init</a>. By default, the handler is called at the end of the playback (or right before the next iteration in a loop), but it can be configured to be called when a sequence is completely loaded. For example: </p>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> event_handler(<a class="code" href="group__nrf__drv__pwm.html#ga645e58c5f9329017a8f9eccca0e05309" title="PWM driver event type.">nrf_drv_pwm_evt_type_t</a> event_type)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (event_type == <a class="code" href="group__nrf__drv__pwm.html#gga645e58c5f9329017a8f9eccca0e05309a4d8ea3fc811d68f34bc46bfe691989b0">NRF_DRV_PWM_EVT_END_SEQ0</a>)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Update sequence 0.</span></div>
<div class="line">        <span class="comment">/* ... */</span></div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (event_type == <a class="code" href="group__nrf__drv__pwm.html#gga645e58c5f9329017a8f9eccca0e05309afff3bfb24c131612a0426dbb0bd8f956">NRF_DRV_PWM_EVT_END_SEQ1</a>)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">// Update sequence 1.</span></div>
<div class="line">        <span class="comment">/* ... */</span></div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/* ... */</span></div>
<div class="line"></div>
<div class="line">    err_code = <a class="code" href="group__nrf__drv__pwm.html#ga61b4f3c36552d7f63840e068142dd625" title="Function for initializing the PWM driver.">nrf_drv_pwm_init</a>(&amp;m_pwm0, &amp;config0, event_handler);</div>
<div class="line"></div>
<div class="line"><span class="comment">/* ... */</span></div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__nrf__drv__pwm.html#gaf5c6c163024bbdfa0e20d97f032a8776" title="Function for starting a two-sequence playback.">nrf_drv_pwm_complex_playback</a>(&amp;m_pwm0, &amp;seq0, &amp;seq1, 1,</div>
<div class="line">        <a class="code" href="group__nrf__drv__pwm.html#gga770fe6d424dc8d8de9c905f32dba4bd1aee252ad8381cb217975de23d23f05b88">NRF_DRV_PWM_FLAG_LOOP</a> |</div>
<div class="line">        <a class="code" href="group__nrf__drv__pwm.html#gga770fe6d424dc8d8de9c905f32dba4bd1a3f542e17c178b0dddc7c05876cbe45be">NRF_DRV_PWM_FLAG_SIGNAL_END_SEQ0</a> |</div>
<div class="line">        <a class="code" href="group__nrf__drv__pwm.html#gga770fe6d424dc8d8de9c905f32dba4bd1acda0539f62111d14a509cbc0b10b100b">NRF_DRV_PWM_FLAG_SIGNAL_END_SEQ1</a> |</div>
<div class="line">        <a class="code" href="group__nrf__drv__pwm.html#gga770fe6d424dc8d8de9c905f32dba4bd1a3cd3847bc9f4ad5170a57d764bf29225">NRF_DRV_PWM_FLAG_NO_EVT_FINISHED</a>);</div>
</div><!-- fragment --><p>Entries in the array of duty cycle values can be modified directly, since the peripheral loads the values as the sequence is played back. If the whole sequence definition must be changed, use <a class="el" href="group__nrf__drv__pwm.html#ga911438661dbd91783ca882e60a2cb497">nrf_drv_pwm_sequence_update</a>. If only some part of the definition must be modified, you can use one of the other updating functions.</p>
<p>It is also possible to start playbacks via <a class="el" href="hardware_driver_ppi.html">PPI</a>. To take advantage of this functionality, use <a class="el" href="group__nrf__drv__pwm.html#gga770fe6d424dc8d8de9c905f32dba4bd1a48ba7c58a1e959d0ac7780067572849a">NRF_DRV_PWM_FLAG_START_VIA_TASK</a> when calling the desired playback function. The function will then only prepare the specified playback, and it will return the address of the task to be triggered. Use the returned value as the task endpoint for the configured PPI channel. Sample code: </p>
<div class="fragment"><div class="line">    uint32_t pwm_start_task_address =</div>
<div class="line">        <a class="code" href="group__nrf__drv__pwm.html#ga14bfdc60b33bb74014c204f2640ad255" title="Function for starting a single sequence playback.">nrf_drv_pwm_simple_playback</a>(&amp;m_pwm0, &amp;seq0, 1,</div>
<div class="line">            <a class="code" href="group__nrf__drv__pwm.html#gga770fe6d424dc8d8de9c905f32dba4bd1a60ab31408c472f81310e2cac7e00c75d">NRF_DRV_PWM_FLAG_STOP</a> |</div>
<div class="line">            <a class="code" href="group__nrf__drv__pwm.html#gga770fe6d424dc8d8de9c905f32dba4bd1a48ba7c58a1e959d0ac7780067572849a">NRF_DRV_PWM_FLAG_START_VIA_TASK</a>);</div>
<div class="line"></div>
<div class="line"><span class="comment">/* ... */</span></div>
<div class="line"></div>
<div class="line">    <a class="code" href="group__nrf__ppi__hal.html#gabb15d5be643cacaa7fa78d89ba1b9e76" title="PPI channels.">nrf_ppi_channel_t</a> ppi_pwm_trigger;</div>
<div class="line">    <a class="code" href="group__app__error.html#ga82d00a810dcea7dcc6af469461fb254c" title="Macro for calling error handler function if supplied error code any other than NRF_SUCCESS.">APP_ERROR_CHECK</a>(<a class="code" href="group__nrf__drv__ppi.html#gacf7e1f7c17901ec68a1307a5e536cffc" title="Function for allocating a PPI channel.">nrf_drv_ppi_channel_alloc</a>(&amp;ppi_pwm_trigger));</div>
<div class="line">    <a class="code" href="group__app__error.html#ga82d00a810dcea7dcc6af469461fb254c" title="Macro for calling error handler function if supplied error code any other than NRF_SUCCESS.">APP_ERROR_CHECK</a>(<a class="code" href="group__nrf__drv__ppi.html#ga5620cf20793f2e513ed6e1db37d64721" title="Function for assigning task and event endpoints to the PPI channel.">nrf_drv_ppi_channel_assign</a>(ppi_pwm_trigger,</div>
<div class="line">        triggering_event_address, pwm_start_task_address));</div>
</div><!-- fragment --><p>At any time, the playback can be stopped by calling <a class="el" href="group__nrf__drv__pwm.html#gaf7145a54c3c1b9c74b2388b24103a429">nrf_drv_pwm_stop</a>. The pulse generation will stop at the end of the current PWM period.</p>
<p>When the PWM driver is no longer needed or its configuration must be changed, call <a class="el" href="group__nrf__drv__pwm.html#gaaf8e1cfc890cffc97de87824c4b08dbb">nrf_drv_pwm_uninit</a>. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<div id="nav-path" class="topicfooter">
<a href="mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback" id="maillink">Documentation feedback</a> | <a href="https://devzone.nordicsemi.com/questions/" target="_blank">Developer Zone</a> | <a href="http://response.nordicsemi.com/subscribe-to-our-newsletters" target="_blank">Subscribe</a> | Updated <span id="date"/>
<script>
var date = new Date("Fri Mar 10 2017" + " UTC");
document.getElementById("date").innerHTML = date.toJSON().slice(0, 10);
var url=window.location.href.split("?")[0];
var filename=url.substring(url.lastIndexOf('/')+1);
document.getElementById("maillink").href = "mailto:docfeedback@nordicsemi.no?subject=Documentation%20feedback"+decodeURIComponent("%26")+"body=File%20name%3A%20"+encodeURIComponent(filename);
</script>
</div>
</body>
</html>
